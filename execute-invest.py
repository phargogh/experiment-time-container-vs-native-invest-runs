# coding=UTF-8
# -----------------------------------------------
# Generated by InVEST 3.14.1 on Thu Jan 25 13:21:30 2024
# Model: Sediment Delivery Ratio

import logging
import os
import pprint
import sys

import natcap.invest.sdr.sdr
import natcap.invest.utils
from osgeo import gdal

gdal.SetCacheMax(2048)  # 2048 MB

LOGGER = logging.getLogger(__name__)
root_logger = logging.getLogger()

handler = logging.StreamHandler(sys.stdout)
formatter = logging.Formatter(
    fmt=natcap.invest.utils.LOG_FMT,
    datefmt='%m/%d/%Y %H:%M:%S ')
handler.setFormatter(formatter)
logging.basicConfig(level=logging.INFO, handlers=[handler])

SCRATCH = os.environ['SCRATCH']
L_SCRATCH = os.environ['L_SCRATCH']  # /lscratch/<username>
OAK = os.environ['OAK']  # /oak/stanford/groups/gdaily

args = {
    'biophysical_table_path': f'{OAK}/users/JesseGoldstein/Colombia3Ps/sediment_national_col.csv',
    'dem_path': f'{OAK}/users/JesseGoldstein/Colombia3Ps/FAB_DEM_Col_fill.tif',
    'drainage_path': '',
    'erodibility_path': f'{OAK}/users/JesseGoldstein/Colombia3Ps/Col_K_factor_soil_erodibility_32718.tif',
    'erosivity_path': f'{OAK}/users/JesseGoldstein/Colombia3Ps/Col_R_factor_rainfall_erosivity_32718.tif',
    'ic_0_param': '0.5',
    'k_param': '2',
    'l_max': '122',
    'lulc_path': f'{OAK}/users/JesseGoldstein/Colombia3Ps/Col_LULC_2010_2012_32718.tif',
    'results_suffix': '',
    'sdr_max': '0.8',
    'threshold_flow_accumulation': '1000',
    'watersheds_path': f'{OAK}/users/JesseGoldstein/Colombia3Ps/Col_watersheds_32718.shp',
    'workspace_dir': f'{SCRATCH}/SDR_results-{sys.argv[1]}',
    'n_workers': -1,
    'flow_dir_algorithm': 'MFD',
}
LOGGER.info(pprint.pformat(args))

if __name__ == '__main__':
    natcap.invest.sdr.sdr.execute(args)
